{
  "id": "BUG-001",
  "type": "bug",
  "title": "Bug: Application crashes when JWT_SECRET env var is missing",
  "module": "core/auth",
  "priority": "P1",
  "created": "2026-02-07",
  "status": "completed",

  "description": "Application fails to start with cryptic error 'JwtStrategy requires a secret or key' when .env file is missing or JWT_SECRET is not set. Should provide clear error message and guidance.",

  "steps_to_reproduce": [
    "Remove or rename .env file",
    "Run npm run start:dev",
    "Observe crash with unhelpful error message"
  ],

  "expected_behavior": "Application should fail gracefully with a clear error message indicating which environment variables are missing and how to fix it (e.g., 'Copy .env.example to .env')",

  "actual_behavior": "Application crashes with 'TypeError: JwtStrategy requires a secret or key' which doesn't clearly indicate the root cause",

  "environment": {
    "version": "current build",
    "conditions": "Missing .env file or JWT_SECRET not set"
  },

  "root_cause_hypothesis": "JwtStrategy constructor passes undefined to passport-jwt when JWT_SECRET env var is not set. No validation or helpful error message is provided.",

  "testing": {
    "regression": [
      "Add test that verifies helpful error when JWT_SECRET is missing",
      "Add test that application starts successfully with valid JWT_SECRET",
      "All existing auth tests must pass"
    ]
  },

  "affected_files_guess": [
    "src/core/auth/strategies/jwt.strategy.ts",
    "src/core/auth/auth.module.ts"
  ],

  "acceptance_criteria": [
    "AC1: When JWT_SECRET is missing, app logs clear error message with fix instructions",
    "AC2: Error message mentions copying .env.example to .env",
    "AC3: Application exits gracefully (not with unhandled exception)",
    "AC4: All existing unit tests continue to pass"
  ],

  "max_iterations": 5
}
